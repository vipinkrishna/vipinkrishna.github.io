{"version":3,"sources":["components/Pincodes.js","components/Age.js","components/Dose.js","components/BusyText.js","components/Commands.js","components/Card.js","components/FindResults.js","Dashboard.js","index.js"],"names":["Pincodes","setPincodes","isEmpty","setIsEmpty","inputRef","useRef","className","type","ref","placeholder","onFocus","onChange","e","pincodesArray","target","value","trim","split","shift","length","pop","Age","setAge","Number","Dose","setDose","BusyText","busy","Commands","findHandler","onClick","Card","item","datestamp","name","address","pincode","min_age_limit","vaccine","available_capacity_dose1","available_capacity_dose2","fee_type","FindResults","data","map","key","Dashboard","useState","findData","setFindData","found","setFound","pincodes","age","dose","processing","setProcessing","setBusy","visitCount","setVisitCount","useEffect","window","scrollTo","top","document","body","scrollHeight","behavior","fetchCount","a","fetch","response","json","result","wait","milliseconds","Promise","settle","setTimeout","console","log","context","AudioContext","dates","today","Date","i","push","toLocaleDateString","day","month","year","setDate","getDate","upcomingDates","vaccineFinder","beep","duration","oscillator","createOscillator","gain","createGain","connect","destination","frequency","start","currentTime","stop","date","endpoint","ok","Error","statusText","warn","message","sessions","session","prevState","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.157d4f0e.chunk.js","sourcesContent":["// import React, { useRef, useEffect } from 'react';\r\nimport React, { useRef } from 'react';\r\nimport \"./Pincodes.css\";\r\n\r\nconst Pincodes = ({ setPincodes, isEmpty, setIsEmpty }) => {\r\n    const inputRef = useRef()\r\n    // const [parsedPincodes, setParsedPincodes] = useState(\"\");\r\n\r\n    // useEffect(() => {\r\n    //     inputRef.current.value = \"671531\"\r\n\r\n    // });\r\n\r\n    const pincodesHandler = (e) => {\r\n        const pincodes = e.target.value;\r\n        let pincodesArray = pincodes.trim().split(/\\D+/)\r\n        !pincodesArray[0] && pincodesArray.shift()\r\n        !pincodesArray[pincodesArray.length - 1] && pincodesArray.pop()\r\n        setPincodes(pincodesArray)\r\n        // setParsedPincodes(pincodesArray.join(', '))\r\n    }\r\n\r\n    return (\r\n        <div className=\"pincodes\">\r\n            <input type=\"text\" ref={inputRef} className={\"pincodes-text \" + (isEmpty ? \"empty\" : \"\")} placeholder=\"Search by Pincode(s)...\" onFocus={() => setIsEmpty(false)} onChange={pincodesHandler} />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Pincodes;","import \"./Age.css\";\r\n\r\nconst Age = ({ setAge }) => {\r\n    return (\r\n        <div className=\"age\">\r\n            <select className=\"age-select\" onChange={(e) => setAge(Number(e.target.value))}>\r\n                <option value=\"18\">Age 18+</option>\r\n                <option value=\"40\">Age 40+</option>\r\n                <option value=\"45\">Age 45+</option>\r\n            </select>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Age;","import \"./Dose.css\";\r\n\r\nconst Dose = ({ setDose }) => {\r\n    return (\r\n        <div className=\"dose\">\r\n            <select className=\"dose-select\" onChange={(e) => setDose(e.target.value)}>\r\n                <option value=\"FIRST\">Dose 1</option>\r\n                <option value=\"SECOND\">Dose 2</option>\r\n            </select>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Dose;","import \"./BusyText.css\";\r\n\r\nconst BusyText = ({ busy }) => {\r\n    return (\r\n        <>\r\n            {\r\n                busy ? <div className=\"rotator\" /> : \"Find\"\r\n            }\r\n        </>\r\n    );\r\n}\r\n\r\nexport default BusyText;\r\n","import \"./Commands.css\";\r\nimport { default as BusyText } from './BusyText';\r\n\r\nconst Commands = ({ findHandler, busy }) => {\r\n    return (\r\n        <div className=\"commands\">\r\n            <button className=\"find-button\" onClick={findHandler}><BusyText busy={busy} /></button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Commands;\r\n","import \"./Card.css\";\r\n\r\nconst Card = ({ item }) => {\r\n    return (\r\n        <div className=\"card\">\r\n            <div className=\"date\"><label>Date: </label>{item.datestamp}</div>\r\n            <div className=\"name\"><label>Center: </label>{item.name}</div>\r\n            <div className=\"address\"><label>Address: </label>{item.address}</div>\r\n            <div className=\"pin\"><label>Pin: </label>{item.pincode}</div>\r\n            <div className=\"ageLimit\"><label>Age: </label>{item.min_age_limit}</div>\r\n            <div className=\"vaccine\"><label>Vaccine: </label>{item.vaccine}</div>\r\n            <div className=\"dose1\"><label>First Dose: </label>{item.available_capacity_dose1}</div>\r\n            <div className=\"dose2\"><label>Second Dose: </label>{item.available_capacity_dose2}</div>\r\n            <div className=\"feeType\"><label>Fee: </label><span className={item.fee_type}>{item.fee_type}</span></div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Card;","import \"./FindResults.css\";\r\nimport { default as Card } from './Card';\r\n\r\nconst FindResults = ({ data }) => {\r\n    return (\r\n        <div className=\"findData\">\r\n            {\r\n                data.map((item, key) => {\r\n                    // console.log(\"xxx: \", item, key)\r\n                    return <Card item={item} key={key} />\r\n                })\r\n            }\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default FindResults;","import React, { useState, useEffect } from 'react';\nimport './Dashboard.css';\nimport { default as Pincodes } from './components/Pincodes';\nimport { default as Age } from './components/Age';\nimport { default as Dose } from './components/Dose';\nimport { default as Commands } from './components/Commands';\nimport { default as FindResults } from './components/FindResults';\n\n// COMPONENT\nfunction Dashboard() {\n  const [findData, setFindData] = useState([]);\n  const [found, setFound] = useState(false);\n\n  // const [pincodes, setPincodes] = useState([671531, 671316]);\n  const [pincodes, setPincodes] = useState([]);\n  const [age, setAge] = useState(18);\n  const [dose, setDose] = useState(\"FIRST\");\n\n  const [processing, setProcessing] = useState(false);\n\n  const [busy, setBusy] = useState(false);\n\n  const [isEmpty, setIsEmpty] = useState(false);\n\n  // const [parsedPincodes, setParsedPincodes] = useState(\"\");\n\n  // const [showAddToHomeButton, setShowAddToHomeButton] = useState(true);\n\n\n\n  const [visitCount, setVisitCount] = useState(null);\n\n  useEffect(() => {\n    if (found) {\n      window.scrollTo({ top: document.body.scrollHeight, behavior: \"smooth\" })\n    }\n  }, [found]);\n\n  useEffect(() => {\n    fetchCount()\n  }, []);\n\n  const fetchCount = async () => {\n    const response = await fetch('https://api.countapi.xyz/hit/vaccineFinder/')\n    const result = await response.json()\n    setVisitCount(result.value)\n  }\n\n  // useEffect(() => {\n  //   console.log('useEffect()')\n  //   window.addEventListener('beforeinstallprompt', (e) => {\n  //     e.preventDefault();\n  //     let deferredPrompt = e;\n  //     console.log(deferredPrompt)\n  //     // addBtn.style.display = 'block';\n  //     // addBtn.style.display = 'none';\n  //     deferredPrompt.prompt();\n  //     deferredPrompt.userChoice.then((choiceResult) => {\n  //       if (choiceResult.outcome === 'accepted') {\n  //         console.log('User accepted the A2HS prompt');\n  //       } else {\n  //         console.log('User dismissed the A2HS prompt');\n  //       }\n  //       deferredPrompt = null;\n  //     });\n  //   });\n  // }, [showAddToHomeButton]);\n\n  // DELAY\n  const wait = (milliseconds) => new Promise((settle) => { setTimeout(settle, milliseconds) })\n\n  // PICKS DATES FROM TODAY UPTO 5 DAYS\n  function upcomingDates() {\n    let today = new Date()\n    const dates = []\n    for (let i = 0; i < 5; i++) {\n      dates.push(today.toLocaleDateString('nl', { day: \"2-digit\", month: \"2-digit\", year: \"numeric\" }))\n      today.setDate(today.getDate() + 1)\n    }\n    return dates\n  }\n\n  // FIND HANDLER\n  function findHandler() {\n    if (processing) {\n      console.log('Processing!')\n      return\n    }\n    setProcessing(true)\n    setBusy(true)\n    console.log('Find Starts!')\n    setFindData([])\n    setFound(false)\n\n    // BEEP SOUND\n    var context = new window.AudioContext()\n    function beep(duration = 500) {\n      var oscillator = context.createOscillator()\n      var gain = context.createGain()\n      oscillator.connect(gain)\n      gain.connect(context.destination)\n      oscillator.frequency.value = 2500\n      oscillator.start(context.currentTime)\n      oscillator.stop(context.currentTime + (duration / 1000))\n    }\n\n    const dates = upcomingDates()\n\n    if (!pincodes.length) {\n      setProcessing(false)\n      setBusy(false)\n      setIsEmpty(true)\n      console.log('Enter Pincode(s)! Find Again...')\n      return\n    }\n    async function vaccineFinder() {\n      for (let pincode of pincodes) {\n        for (let date of dates) {\n          let endpoint = \"https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByPin?pincode=\" + pincode + \"&date=\" + date\n          let response\n          try {\n            response = await fetch(endpoint)\n            if (!response.ok) throw new Error(response.statusText)\n          } catch (err) {\n            console.warn(err.message)\n            return\n          }\n          let { sessions } = await response.json()\n\n          for (let session of sessions) {\n            const { date: datestamp, name, address, pincode, available_capacity_dose1, available_capacity_dose2, vaccine, min_age_limit, fee_type } = session\n            if (min_age_limit === age && ((dose === \"FIRST\") ? available_capacity_dose1 : available_capacity_dose2) > 0) {\n              setFindData(prevState => [...prevState, { datestamp, pincode, name, address, vaccine, min_age_limit, available_capacity_dose1, available_capacity_dose2, fee_type }])\n              beep(200)\n              await wait(300)\n            }\n          }\n          await wait(50)\n        }\n      }\n      setProcessing(false)\n      setBusy(false)\n      setFound(true)\n      console.log('Find Done! Find Again...')\n    }\n    pincodes.length && dates.length && age && dose && vaccineFinder()\n  }\n\n  // const addToHomeHandler = () => {\n  //   setShowAddToHomeButton(false)\n  // }\n\n  return (\n    <>\n      <div className=\"dashboard\">\n        <div className=\"inputs\">\n          <Pincodes setPincodes={setPincodes} isEmpty={isEmpty} setIsEmpty={setIsEmpty} />\n          <Age setAge={setAge} />\n          <Dose setDose={setDose} />\n        </div>\n        <Commands findHandler={findHandler} busy={busy} />\n        <div className=\"watermark\">vaccineFinder &copy; vipinkrishna 2021 {visitCount && (\"- visits:\" + visitCount)}</div>\n        {/* <button className=\"addToHome\" onClick={addToHomeHandler} style={{ display: showAddToHomeButton ? 'block' : 'none' }}>Add to Home Screen</button> */}\n      </div>\n      <div className=\"findResults\">\n        <FindResults data={findData} />\n      </div>\n    </>\n  );\n}\n\nexport default Dashboard;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Dashboard from './Dashboard';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Dashboard />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}